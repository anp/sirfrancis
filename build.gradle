plugins {
    id 'java'
    id 'application'
    id 'com.github.johnrengelman.shadow' version '1.2.0'
    id 'org.hidetake.ssh' version '1.0.1'
}

sourceCompatibility = 1.8
targetCompatibility = 1.8
version = '0.1-COMINGSOON'

[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

//fill this out and uncomment
mainClassName = 'io.sirfrancis.bacon.BaconApplication'

repositories {
    mavenCentral()
    maven {
        url "https://oss.sonatype.org/content/repositories/snapshots"
    }
}

dependencies {
    def dropwizardVersion = '0.7.1'
    def orientDBVersion = '2.0-rc2'
    compile(
            'io.dropwizard:dropwizard-core:' + dropwizardVersion,
            'io.dropwizard:dropwizard-client:' + dropwizardVersion,
            'io.dropwizard:dropwizard-auth:' + dropwizardVersion,
            'io.dropwizard:dropwizard-jdbi:' + dropwizardVersion,
            'io.dropwizard:dropwizard-views-mustache:' + dropwizardVersion,
            'com.orientechnologies:orientdb-graphdb:' + orientDBVersion,
            'com.orientechnologies:orientdb-lucene:' + orientDBVersion,
            'org.apache.lucene:lucene-core:4.7.0',
            'org.apache.lucene:lucene-analyzers-common:4.7.0',
            'org.apache.lucene:lucene-queryparser:4.7.0',
            'org.apache.lucene:lucene-misc:4.7.0',
            'org.apache.lucene:lucene-spatial:4.7.0',
    )
    testCompile (
            'junit:junit:4.11',
            'net.sf.opencsv:opencsv:2.3'
    )
}

run {
    //MAKE SURE CONFIG PATH IS CORRECT
    args 'server', 'bacon-local.yml'
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.2.1'
}

// Configure the shadow jar task
shadowJar {
    mergeServiceFiles()
    exclude('META-INF/*.DSA')
    exclude('META-INF/*.RSA')
}

jar {
    manifest {
        attributes (
            'Main-Class': mainClassName,
            'Implementation-Title': "Bacon",
            'Implementation-Version': version
        )
    }
}
